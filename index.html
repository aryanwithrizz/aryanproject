<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Aryan's Market - Ultimate AI Shopping</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
    
    <!-- External Libraries -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/particles.js@2.0.0/particles.min.js"></script>
    
    <style>
        :root {
            --primary: #8B5CF6;
            --primary-dark: #6D28D9;
            --secondary: #EC4899;
            --success: #10B981;
            --danger: #EF4444;
            --warning: #F59E0B;
            --info: #3B82F6;
            --dark: #0F0F0F;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Poppins', sans-serif;
            background: var(--dark);
            color: #fff;
            overflow-x: hidden;
        }

        #particles-js {
            position: fixed;
            width: 100%;
            height: 100%;
            z-index: 0;
            opacity: 0.4;
        }

        .page {
            display: none;
            position: fixed;
            inset: 0;
            z-index: 10;
        }

        .page.active {
            display: block;
            animation: pageIn 0.6s cubic-bezier(0.4, 0, 0.2, 1);
        }

        @keyframes pageIn {
            from { opacity: 0; transform: translateX(100%) scale(0.95); }
            to { opacity: 1; transform: translateX(0) scale(1); }
        }

        /* ========== LOADING ========== */
        #loadingPage {
            background: linear-gradient(135deg, #1a0033, #000);
            display: flex;
            align-items: center;
            justify-content: center;
            flex-direction: column;
        }

        .loader-logo {
            font-size: 64px;
            font-weight: 900;
            background: linear-gradient(135deg, #fff, var(--primary), var(--secondary));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 30px;
            animation: glow 2s ease-in-out infinite;
        }

        @keyframes glow {
            0%, 100% { filter: drop-shadow(0 0 30px rgba(139, 92, 246, 0.8)); }
            50% { filter: drop-shadow(0 0 60px rgba(139, 92, 246, 1)); }
        }

        .loader-ring {
            width: 100px;
            height: 100px;
            border: 5px solid rgba(139, 92, 246, 0.2);
            border-top-color: var(--primary);
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-bottom: 20px;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .progress-bar {
            width: 300px;
            height: 6px;
            background: rgba(255,255,255,0.1);
            border-radius: 3px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--primary), var(--secondary));
            animation: progress 3s ease-out forwards;
        }

        @keyframes progress {
            from { width: 0; }
            to { width: 100%; }
        }

        /* ========== AUTH PAGE ========== */
        #authPage {
            background: 
                radial-gradient(circle at 20% 30%, rgba(139, 92, 246, 0.3), transparent 50%),
                radial-gradient(circle at 80% 70%, rgba(236, 72, 153, 0.3), transparent 50%),
                linear-gradient(135deg, #000, #1a0033);
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
            overflow-y: auto;
        }

        .auth-box {
            background: rgba(26, 26, 26, 0.95);
            backdrop-filter: blur(30px);
            border: 2px solid rgba(139, 92, 246, 0.5);
            border-radius: 25px;
            padding: 45px 40px;
            max-width: 480px;
            width: 100%;
            box-shadow: 0 30px 80px rgba(139, 92, 246, 0.4);
            animation: float 3s ease-in-out infinite;
        }

        @keyframes float {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }

        .logo {
            text-align: center;
            font-size: 48px;
            font-weight: 900;
            background: linear-gradient(135deg, #fff, var(--primary), var(--secondary));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 10px;
        }

        .tagline {
            text-align: center;
            color: rgba(255,255,255,0.6);
            margin-bottom: 30px;
            font-size: 14px;
        }

        .stats {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 12px;
            margin-bottom: 30px;
        }

        .stat {
            text-align: center;
            padding: 12px;
            background: rgba(139, 92, 246, 0.1);
            border-radius: 12px;
            border: 1px solid rgba(139, 92, 246, 0.3);
        }

        .stat-val {
            font-size: 22px;
            font-weight: 800;
            color: var(--primary);
        }

        .stat-lbl {
            font-size: 10px;
            color: rgba(255,255,255,0.5);
            text-transform: uppercase;
        }

        .input-grp {
            margin-bottom: 16px;
            position: relative;
        }

        .input-icon {
            position: absolute;
            left: 16px;
            top: 50%;
            transform: translateY(-50%);
            font-size: 18px;
            opacity: 0.4;
        }

        .input {
            width: 100%;
            padding: 14px 20px 14px 45px;
            background: rgba(255,255,255,0.05);
            border: 2px solid rgba(139, 92, 246, 0.3);
            border-radius: 12px;
            color: #fff;
            font-size: 14px;
            transition: all 0.3s;
        }

        .input:focus {
            outline: none;
            border-color: var(--primary);
            background: rgba(255,255,255,0.08);
            box-shadow: 0 0 0 4px rgba(139, 92, 246, 0.1);
        }

        .btn {
            width: 100%;
            padding: 16px;
            border: none;
            border-radius: 12px;
            font-size: 16px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s;
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--primary), var(--primary-dark));
            color: #fff;
            box-shadow: 0 10px 30px rgba(139, 92, 246, 0.4);
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 15px 40px rgba(139, 92, 246, 0.6);
        }

        .link {
            color: var(--info);
            cursor: pointer;
            font-weight: 600;
        }

        .link:hover {
            text-decoration: underline;
        }

        .hidden {
            display: none;
        }

        /* ========== HOME PAGE ========== */
        #homePage {
            background: linear-gradient(135deg, var(--dark), #1a1a2e);
        }

        .navbar {
            background: rgba(26, 26, 26, 0.95);
            backdrop-filter: blur(20px);
            padding: 16px 30px;
            display: flex;
            align-items: center;
            gap: 20px;
            border-bottom: 2px solid rgba(139, 92, 246, 0.3);
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .nav-logo {
            font-size: 24px;
            font-weight: 800;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            cursor: pointer;
        }

        .search-box {
            flex: 1;
            max-width: 500px;
            position: relative;
        }

        .search-input {
            width: 100%;
            padding: 12px 90px 12px 45px;
            background: rgba(255,255,255,0.05);
            border: 2px solid rgba(139, 92, 246, 0.3);
            border-radius: 20px;
            color: #fff;
            font-size: 14px;
        }

        .search-icon {
            position: absolute;
            left: 16px;
            top: 50%;
            transform: translateY(-50%);
            font-size: 18px;
            opacity: 0.4;
        }

        .voice-btn {
            position: absolute;
            right: 50px;
            top: 50%;
            transform: translateY(-50%);
            background: none;
            border: none;
            color: rgba(255,255,255,0.6);
            font-size: 20px;
            cursor: pointer;
        }

        .voice-btn.active {
            color: var(--danger);
            animation: pulse 1s infinite;
        }

        @keyframes pulse {
            0%, 100% { transform: translateY(-50%) scale(1); }
            50% { transform: translateY(-50%) scale(1.2); }
        }

        .ai-btn {
            position: absolute;
            right: 12px;
            top: 50%;
            transform: translateY(-50%);
            padding: 6px 12px;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            border: none;
            border-radius: 15px;
            color: #fff;
            font-size: 12px;
            font-weight: 600;
            cursor: pointer;
        }

        .nav-actions {
            display: flex;
            gap: 12px;
        }

        .nav-btn {
            padding: 10px 18px;
            background: rgba(139, 92, 246, 0.15);
            border: 2px solid var(--primary);
            border-radius: 10px;
            color: #fff;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            position: relative;
        }

        .nav-btn:hover {
            background: rgba(139, 92, 246, 0.3);
        }

        .badge {
            position: absolute;
            top: -6px;
            right: -6px;
            background: var(--danger);
            color: #fff;
            font-size: 10px;
            font-weight: 700;
            min-width: 18px;
            height: 18px;
            border-radius: 9px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .main {
            height: calc(100vh - 60px);
            overflow-y: auto;
            padding: 30px;
        }

        /* ========== CAROUSEL ========== */
        .section-title {
            font-size: 36px;
            font-weight: 800;
            text-align: center;
            margin-bottom: 40px;
            background: linear-gradient(135deg, #fff, var(--primary));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .carousel-3d {
            perspective: 1800px;
            height: 450px;
            position: relative;
            margin-bottom: 60px;
        }

        .carousel-inner {
            width: 100%;
            height: 100%;
            position: relative;
            transform-style: preserve-3d;
            animation: rotate 25s linear infinite;
        }

        @keyframes rotate {
            0% { transform: rotateY(0deg); }
            100% { transform: rotateY(360deg); }
        }

        .carousel-inner:hover {
            animation-play-state: paused;
        }

        .carousel-item {
            position: absolute;
            width: 280px;
            height: 350px;
            left: 50%;
            top: 50%;
            margin-left: -140px;
            margin-top: -175px;
            background: linear-gradient(135deg, rgba(139, 92, 246, 0.2), rgba(109, 40, 217, 0.3));
            border: 2px solid rgba(139, 92, 246, 0.5);
            border-radius: 20px;
            padding: 30px;
            text-align: center;
            cursor: pointer;
            transition: all 0.4s;
            backdrop-filter: blur(10px);
        }

        .carousel-item:hover {
            transform: scale(1.15) !important;
            border-color: var(--primary);
            box-shadow: 0 30px 70px rgba(139, 92, 246, 0.6);
            z-index: 10;
        }

        .carousel-item:nth-child(1) { transform: rotateY(0deg) translateZ(450px); }
        .carousel-item:nth-child(2) { transform: rotateY(72deg) translateZ(450px); }
        .carousel-item:nth-child(3) { transform: rotateY(144deg) translateZ(450px); }
        .carousel-item:nth-child(4) { transform: rotateY(216deg) translateZ(450px); }
        .carousel-item:nth-child(5) { transform: rotateY(288deg) translateZ(450px); }

        .cat-icon {
            font-size: 90px;
            margin-bottom: 20px;
            animation: iconFloat 3s ease-in-out infinite;
        }

        @keyframes iconFloat {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-15px); }
        }

        .cat-name {
            font-size: 26px;
            font-weight: 700;
        }

        /* ========== PRODUCT SHOWCASE ========== */
        .product-show {
            display: flex;
            gap: 60px;
            align-items: center;
            max-width: 1300px;
            margin: 60px auto;
            padding: 35px;
            background: rgba(26, 26, 26, 0.6);
            border-radius: 25px;
            border: 2px solid rgba(139, 92, 246, 0.3);
        }

        .product-3d-box {
            flex: 1;
            perspective: 1500px;
        }

        .product-3d {
            width: 450px;
            height: 450px;
            position: relative;
            transform-style: preserve-3d;
            animation: rotate3d 10s linear infinite;
        }

        @keyframes rotate3d {
            0% { transform: rotateY(0deg) rotateX(5deg); }
            100% { transform: rotateY(360deg) rotateX(5deg); }
        }

        .product-3d:hover {
            animation-play-state: paused;
        }

        .product-img {
            width: 100%;
            height: 100%;
            object-fit: contain;
            border-radius: 20px;
            box-shadow: 0 30px 80px rgba(0, 0, 0, 0.7);
            background: rgba(255,255,255,0.02);
            padding: 25px;
        }

        .product-info {
            flex: 1;
        }

        .product-cat {
            display: inline-block;
            padding: 6px 16px;
            background: rgba(139, 92, 246, 0.2);
            border: 1px solid var(--primary);
            border-radius: 15px;
            font-size: 12px;
            margin-bottom: 15px;
        }

        .product-name {
            font-size: 40px;
            font-weight: 800;
            margin-bottom: 15px;
            background: linear-gradient(135deg, #fff, var(--primary));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .product-rating {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 15px;
        }

        .stars {
            color: #F59E0B;
            font-size: 18px;
        }

        .product-price {
            font-size: 48px;
            font-weight: 900;
            color: var(--success);
            margin-bottom: 10px;
        }

        .price-old {
            font-size: 24px;
            color: rgba(255,255,255,0.4);
            text-decoration: line-through;
            margin-left: 12px;
        }

        .discount {
            display: inline-block;
            padding: 4px 12px;
            background: var(--danger);
            border-radius: 12px;
            font-size: 13px;
            font-weight: 700;
            margin-left: 12px;
        }

        .product-desc {
            font-size: 15px;
            color: rgba(255,255,255,0.7);
            line-height: 1.7;
            margin-bottom: 25px;
        }

        .features {
            margin-bottom: 25px;
        }

        .feature {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 10px;
            color: rgba(255,255,255,0.8);
        }

        .feature-icon {
            color: var(--success);
            font-size: 18px;
        }

        .product-btns {
            display: flex;
            gap: 15px;
            margin-bottom: 25px;
        }

        .btn-cart, .btn-buy {
            flex: 1;
            padding: 18px;
            border: none;
            border-radius: 15px;
            font-size: 16px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s;
        }

        .btn-cart {
            background: rgba(139, 92, 246, 0.2);
            border: 2px solid var(--primary);
            color: #fff;
        }

        .btn-cart:hover {
            background: var(--primary);
            transform: translateY(-2px);
            box-shadow: 0 15px 35px rgba(139, 92, 246, 0.5);
        }

        .btn-buy {
            background: linear-gradient(135deg, var(--success), #059669);
            color: #fff;
            box-shadow: 0 10px 30px rgba(16, 185, 129, 0.4);
        }

        .btn-buy:hover {
            transform: translateY(-2px);
            box-shadow: 0 15px 40px rgba(16, 185, 129, 0.6);
        }

        .nav-arrows {
            display: flex;
            gap: 12px;
        }

        .arrow {
            width: 50px;
            height: 50px;
            background: rgba(139, 92, 246, 0.2);
            border: 2px solid var(--primary);
            border-radius: 50%;
            color: #fff;
            font-size: 20px;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .arrow:hover {
            background: var(--primary);
            transform: scale(1.1);
        }

        /* ========== RECOMMENDATIONS ========== */
        .products-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(260px, 1fr));
            gap: 25px;
            margin-top: 40px;
        }

        .product-card {
            background: rgba(26, 26, 26, 0.8);
            border: 2px solid rgba(139, 92, 246, 0.3);
            border-radius: 18px;
            overflow: hidden;
            cursor: pointer;
            transition: all 0.3s;
        }

        .product-card:hover {
            transform: translateY(-8px);
            border-color: var(--primary);
            box-shadow: 0 20px 50px rgba(139, 92, 246, 0.4);
        }

        .card-img {
            width: 100%;
            height: 220px;
            object-fit: cover;
        }

        .card-content {
            padding: 18px;
        }

        .card-name {
            font-size: 16px;
            font-weight: 600;
            margin-bottom: 10px;
        }

        .card-price {
            font-size: 22px;
            font-weight: 800;
            color: var(--success);
            margin-bottom: 12px;
        }

        .card-btns {
            display: flex;
            gap: 8px;
        }

        .card-btn {
            flex: 1;
            padding: 10px;
            border: none;
            border-radius: 10px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
        }

        .card-btn-cart {
            background: rgba(139, 92, 246, 0.2);
            border: 2px solid var(--primary);
            color: #fff;
        }

        .card-btn-cart:hover {
            background: var(--primary);
        }

        .card-btn-buy {
            background: var(--success);
            color: #fff;
        }

        /* ========== CART ========== */
        .cart-item {
            background: rgba(26, 26, 26, 0.9);
            border: 2px solid rgba(139, 92, 246, 0.3);
            border-radius: 18px;
            padding: 20px;
            margin-bottom: 15px;
            display: flex;
            gap: 20px;
            align-items: center;
        }

        .cart-img {
            width: 100px;
            height: 100px;
            object-fit: contain;
            border-radius: 12px;
        }

        .cart-details {
            flex: 1;
        }

        .cart-name {
            font-size: 20px;
            font-weight: 700;
            margin-bottom: 8px;
        }

        .cart-price {
            font-size: 24px;
            font-weight: 800;
            color: var(--success);
            margin-bottom: 12px;
        }

        .qty-control {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .qty-btn {
            width: 32px;
            height: 32px;
            background: rgba(139, 92, 246, 0.2);
            border: 2px solid var(--primary);
            border-radius: 50%;
            color: #fff;
            font-size: 18px;
            cursor: pointer;
        }

        .qty-btn:hover {
            background: var(--primary);
        }

        .btn-remove {
            padding: 10px 20px;
            background: rgba(239, 68, 68, 0.15);
            border: 2px solid var(--danger);
            border-radius: 10px;
            color: var(--danger);
            font-weight: 600;
            cursor: pointer;
        }

        .btn-remove:hover {
            background: var(--danger);
            color: #fff;
        }

        .cart-summary {
            background: linear-gradient(135deg, rgba(139, 92, 246, 0.2), rgba(109, 40, 217, 0.3));
            border: 2px solid var(--primary);
            border-radius: 20px;
            padding: 30px;
            margin-top: 25px;
        }

        .summary-row {
            display: flex;
            justify-content: space-between;
            margin-bottom: 12px;
            font-size: 16px;
        }

        .summary-total {
            display: flex;
            justify-content: space-between;
            font-size: 28px;
            font-weight: 900;
            margin-top: 20px;
            padding-top: 20px;
            border-top: 2px solid rgba(139, 92, 246, 0.5);
        }

        .total-amt {
            color: var(--success);
        }

        .btn-checkout {
            width: 100%;
            padding: 18px;
            background: linear-gradient(135deg, var(--success), #059669);
            border: none;
            border-radius: 15px;
            color: #fff;
            font-size: 20px;
            font-weight: 700;
            cursor: pointer;
            margin-top: 20px;
            box-shadow: 0 15px 40px rgba(16, 185, 129, 0.4);
        }

        .btn-checkout:hover {
            transform: translateY(-2px);
        }

        .empty {
            text-align: center;
            padding: 80px 20px;
        }

        .empty-icon {
            font-size: 100px;
            margin-bottom: 20px;
            opacity: 0.2;
        }

        .empty-text {
            font-size: 24px;
            color: rgba(255,255,255,0.4);
        }

        /* ========== CHATBOT ========== */
        .chatbot {
            position: fixed;
            bottom: 25px;
            right: 25px;
            z-index: 1000;
        }

        .chatbot-toggle {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            border: none;
            color: #fff;
            font-size: 28px;
            cursor: pointer;
            box-shadow: 0 10px 30px rgba(139, 92, 246, 0.5);
        }

        .chatbot-toggle:hover {
            transform: scale(1.1);
        }

        .chatbot-window {
            position: absolute;
            bottom: 80px;
            right: 0;
            width: 350px;
            height: 500px;
            background: rgba(26, 26, 26, 0.98);
            backdrop-filter: blur(30px);
            border: 2px solid rgba(139, 92, 246, 0.5);
            border-radius: 20px;
            display: none;
            flex-direction: column;
            box-shadow: 0 25px 70px rgba(0, 0, 0, 0.8);
        }

        .chatbot-window.active {
            display: flex;
            animation: slideUp 0.3s;
        }

        @keyframes slideUp {
            from { transform: translateY(30px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }

        .chat-header {
            padding: 18px;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            border-radius: 18px 18px 0 0;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .chat-title {
            font-size: 16px;
            font-weight: 700;
        }

        .chat-close {
            background: none;
            border: none;
            color: #fff;
            font-size: 22px;
            cursor: pointer;
        }

        .chat-messages {
            flex: 1;
            padding: 18px;
            overflow-y: auto;
        }

        .chat-msg {
            margin-bottom: 12px;
            animation: msgIn 0.3s;
        }

        @keyframes msgIn {
            from { transform: translateY(15px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }

        .chat-bubble {
            display: inline-block;
            padding: 10px 15px;
            border-radius: 15px;
            max-width: 80%;
        }

        .chat-msg.bot .chat-bubble {
            background: rgba(139, 92, 246, 0.2);
            border: 1px solid rgba(139, 92, 246, 0.4);
        }

        .chat-msg.user .chat-bubble {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            float: right;
        }

        .chat-input-area {
            padding: 15px;
            border-top: 1px solid rgba(139, 92, 246, 0.3);
            position: relative;
        }

        .chat-input {
            width: 100%;
            padding: 10px 40px 10px 12px;
            background: rgba(255,255,255,0.05);
            border: 2px solid rgba(139, 92, 246, 0.3);
            border-radius: 18px;
            color: #fff;
            font-size: 13px;
        }

        .chat-send {
            position: absolute;
            right: 23px;
            bottom: 23px;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            border: none;
            width: 32px;
            height: 32px;
            border-radius: 50%;
            color: #fff;
            cursor: pointer;
        }

        /* ========== DELIVERY VAN ========== */
        .van {
            position: fixed;
            left: -450px;
            bottom: 50%;
            transform: translateY(50%);
            z-index: 9999;
            display: none;
        }

        .van.active {
            display: block;
            animation: drive 5s ease-in-out forwards;
        }

        @keyframes drive {
            0% { left: -450px; }
            35% { left: calc(50% - 180px); }
            65% { left: calc(50% - 180px); }
            100% { left: 120%; }
        }

        .van-body {
            width: 320px;
            height: 180px;
            position: relative;
        }

        .van-cabin {
            width: 110px;
            height: 100px;
            background: linear-gradient(135deg, var(--info), #1D4ED8);
            border-radius: 12px 0 0 0;
            position: absolute;
            left: 0;
            bottom: 45px;
        }

        .van-cargo {
            width: 190px;
            height: 130px;
            background: linear-gradient(135deg, #2563EB, #1E40AF);
            border-radius: 0 18px 0 0;
            position: absolute;
            left: 110px;
            bottom: 45px;
        }

        .van-door {
            width: 75px;
            height: 110px;
            background: #1D4ED8;
            border-radius: 0 12px 0 0;
            position: absolute;
            right: 5px;
            top: 10px;
            transform-origin: left center;
            animation: doorOpen 1.6s 2.2s ease-out forwards;
        }

        @keyframes doorOpen {
            0% { transform: rotateY(0deg); }
            100% { transform: rotateY(-130deg); }
        }

        .van-box {
            width: 55px;
            height: 55px;
            background: linear-gradient(135deg, var(--secondary), #BE185D);
            border-radius: 8px;
            position: absolute;
            right: 35px;
            top: 45px;
            opacity: 0;
            animation: boxLoad 1.3s 3.2s ease-out forwards;
        }

        @keyframes boxLoad {
            0% { opacity: 0; transform: translateX(100px); }
            50% { opacity: 1; }
            100% { opacity: 1; transform: translateX(-20px); }
        }

        .van-wheel {
            width: 50px;
            height: 50px;
            background: #1F2937;
            border-radius: 50%;
            border: 6px solid #374151;
            position: absolute;
            bottom: 0;
            animation: wheelSpin 0.6s linear infinite;
        }

        @keyframes wheelSpin {
            to { transform: rotate(360deg); }
        }

        .van-wheel:nth-child(1) { left: 35px; }
        .van-wheel:nth-child(2) { left: 240px; }

        /* ========== MODAL ========== */
        .modal {
            position: fixed;
            inset: 0;
            background: rgba(0, 0, 0, 0.95);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 10000;
        }

        .modal.active {
            display: flex;
            animation: fadeIn 0.4s;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        .modal-content {
            text-align: center;
            animation: zoomIn 0.5s cubic-bezier(0.68, -0.55, 0.265, 1.55);
        }

        @keyframes zoomIn {
            0% { transform: scale(0) rotate(-180deg); opacity: 0; }
            100% { transform: scale(1) rotate(0deg); opacity: 1; }
        }

        .success-icon {
            font-size: 140px;
            margin-bottom: 30px;
            animation: successPulse 1.5s ease-in-out infinite;
        }

        @keyframes successPulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }

        .success-title {
            font-size: 50px;
            font-weight: 800;
            color: var(--success);
            margin-bottom: 20px;
        }

        .success-msg {
            font-size: 20px;
            color: rgba(255,255,255,0.7);
            margin-bottom: 35px;
        }

        .order-box {
            background: rgba(139, 92, 246, 0.2);
            border: 2px solid var(--primary);
            border-radius: 18px;
            padding: 25px 45px;
            margin-bottom: 40px;
            display: inline-block;
        }

        .order-lbl {
            font-size: 14px;
            color: rgba(255,255,255,0.6);
            margin-bottom: 10px;
        }

        .order-id {
            font-size: 28px;
            font-weight: 800;
            color: var(--success);
        }

        /* ========== ADMIN ========== */
        .admin-header {
            background: linear-gradient(135deg, var(--primary), var(--primary-dark));
            border-radius: 22px;
            padding: 35px 45px;
            margin-bottom: 40px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .admin-title {
            font-size: 38px;
            font-weight: 800;
        }

        .btn-logout {
            padding: 14px 30px;
            background: rgba(255,255,255,0.2);
            border: 2px solid rgba(255,255,255,0.4);
            border-radius: 12px;
            color: #fff;
            font-weight: 600;
            cursor: pointer;
        }

        .btn-logout:hover {
            background: var(--danger);
            border-color: var(--danger);
        }

        .admin-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 25px;
            margin-bottom: 40px;
        }

        .admin-stat {
            background: rgba(26, 26, 26, 0.9);
            border: 2px solid rgba(139, 92, 246, 0.3);
            border-radius: 20px;
            padding: 35px;
            text-align: center;
        }

        .stat-num {
            font-size: 52px;
            font-weight: 900;
            color: var(--success);
            margin-bottom: 12px;
        }

        .stat-desc {
            font-size: 14px;
            color: rgba(255,255,255,0.6);
            text-transform: uppercase;
        }

        .admin-table {
            background: rgba(26, 26, 26, 0.9);
            border: 2px solid rgba(139, 92, 246, 0.3);
            border-radius: 22px;
            padding: 30px;
            overflow-x: auto;
        }

        table {
            width: 100%;
            border-collapse: collapse;
        }

        th {
            background: rgba(139, 92, 246, 0.2);
            padding: 16px;
            text-align: left;
            font-weight: 700;
            font-size: 13px;
            text-transform: uppercase;
            color: #A78BFA;
            border-bottom: 2px solid var(--primary);
        }

        td {
            padding: 16px;
            border-bottom: 1px solid rgba(139, 92, 246, 0.1);
        }

        tr:hover {
            background: rgba(139, 92, 246, 0.05);
        }

        .btn-action {
            padding: 8px 16px;
            background: rgba(239, 68, 68, 0.15);
            border: 1px solid var(--danger);
            border-radius: 8px;
            color: var(--danger);
            font-weight: 600;
            cursor: pointer;
        }

        .btn-action:hover {
            background: var(--danger);
            color: #fff;
        }

        /* ========== RESPONSIVE ========== */
        @media (max-width: 768px) {
            .navbar {
                flex-wrap: wrap;
            }

            .search-box {
                order: 3;
                width: 100%;
                margin-top: 12px;
            }

            .product-show {
                flex-direction: column;
            }

            .product-3d {
                width: 100%;
                max-width: 400px;
                height: 400px;
            }

            .carousel-3d {
                height: 350px;
            }

            .chatbot-window {
                width: 100%;
                height: 100%;
                border-radius: 0;
                bottom: 0;
            }

            .admin-header {
                flex-direction: column;
                gap: 20px;
            }
        }
    </style>
</head>
<body>

    <div id="particles-js"></div>

    <!-- LOADING -->
    <div id="loadingPage" class="page active">
        <div class="loader-logo">ARYAN'S MARKET</div>
        <div class="loader-ring"></div>
        <div style="color: rgba(255,255,255,0.7); margin-bottom: 20px;">Loading Ultimate Experience...</div>
        <div class="progress-bar">
            <div class="progress-fill"></div>
        </div>
    </div>

    <!-- AUTH -->
    <div id="authPage" class="page">
        <div class="auth-box">
            <div class="logo">ARYAN'S MARKET</div>
            <div class="tagline">AI-Powered Shopping</div>
            
            <div class="stats">
                <div class="stat">
                    <div class="stat-val">1M+</div>
                    <div class="stat-lbl">Users</div>
                </div>
                <div class="stat">
                    <div class="stat-val">100K+</div>
                    <div class="stat-lbl">Orders</div>
                </div>
                <div class="stat">
                    <div class="stat-val">50K+</div>
                    <div class="stat-lbl">Products</div>
                </div>
            </div>

            <div id="loginForm">
                <div style="font-size: 24px; font-weight: 700; margin-bottom: 20px;">Welcome Back</div>
                <div class="input-grp">
                    <span class="input-icon">üìß</span>
                    <input type="email" class="input" placeholder="Email" id="loginEmail">
                </div>
                <div class="input-grp">
                    <span class="input-icon">üîí</span>
                    <input type="password" class="input" placeholder="Password" id="loginPass">
                </div>
                <div style="text-align: right; margin-bottom: 15px;">
                    <span class="link" style="font-size: 13px;" onclick="resetPass()">Forgot Password?</span>
                </div>
                <button class="btn btn-primary" onclick="login()">Sign In</button>
                <div style="text-align: center; margin-top: 15px; font-size: 14px; color: rgba(255,255,255,0.6);">
                    Don't have account? <span class="link" onclick="showSignup()">Create Account</span>
                </div>
            </div>

            <div id="signupForm" class="hidden">
                <div style="font-size: 24px; font-weight: 700; margin-bottom: 20px;">Create Account</div>
                <div class="input-grp">
                    <span class="input-icon">üë§</span>
                    <input type="text" class="input" placeholder="Full Name" id="signupName">
                </div>
                <div class="input-grp">
                    <span class="input-icon">üìß</span>
                    <input type="email" class="input" placeholder="Email" id="signupEmail">
                </div>
                <div class="input-grp">
                    <span class="input-icon">üîí</span>
                    <input type="password" class="input" placeholder="Password" id="signupPass">
                </div>
                <button class="btn btn-primary" onclick="signup()">Create Account</button>
                <div style="text-align: center; margin-top: 15px; font-size: 14px; color: rgba(255,255,255,0.6);">
                    Already have account? <span class="link" onclick="showLogin()">Sign In</span>
                </div>
            </div>
        </div>
    </div>

    <!-- HOME -->
    <div id="homePage" class="page">
        <div class="navbar">
            <div class="nav-logo">Aryan's Market</div>
            <div class="search-box">
                <span class="search-icon">üîç</span>
                <input type="text" class="search-input" placeholder="Search..." id="searchInput" oninput="search()">
                <button class="voice-btn" id="voiceBtn" onclick="voiceSearch()">üé§</button>
                <button class="ai-btn" onclick="toggleChat()">AI</button>
            </div>
            <div class="nav-actions">
                <button class="nav-btn" onclick="openCart()">
                    üõí Cart
                    <span class="badge" id="cartBadge">0</span>
                </button>
                <button class="nav-btn" onclick="profile()">üë§</button>
            </div>
        </div>

        <div class="main">
            <div class="section-title">Shop by Category</div>
            <div class="carousel-3d">
                <div class="carousel-inner">
                    <div class="carousel-item" onclick="filterCat('Electronics')">
                        <div class="cat-icon">üì±</div>
                        <div class="cat-name">Electronics</div>
                    </div>
                    <div class="carousel-item" onclick="filterCat('Grocery')">
                        <div class="cat-icon">üõí</div>
                        <div class="cat-name">Grocery</div>
                    </div>
                    <div class="carousel-item" onclick="filterCat('Fashion')">
                        <div class="cat-icon">üëï</div>
                        <div class="cat-name">Fashion</div>
                    </div>
                    <div class="carousel-item" onclick="filterCat('Home')">
                        <div class="cat-icon">üè†</div>
                        <div class="cat-name">Home</div>
                    </div>
                    <div class="carousel-item" onclick="filterCat('Beauty')">
                        <div class="cat-icon">üíÑ</div>
                        <div class="cat-name">Beauty</div>
                    </div>
                </div>
            </div>

            <div class="section-title" id="catTitle">Featured Products</div>
            <div class="product-show">
                <div class="product-3d-box">
                    <div class="product-3d">
                        <img id="pImg" src="" class="product-img">
                    </div>
                </div>
                <div class="product-info">
                    <span class="product-cat" id="pCat"></span>
                    <div class="product-name" id="pName"></div>
                    <div class="product-rating">
                        <span class="stars">‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê</span>
                        <span style="font-size: 13px; color: rgba(255,255,255,0.6);">(4.8/5)</span>
                    </div>
                    <div>
                        <span class="product-price" id="pPrice"></span>
                        <span class="price-old" id="pOld"></span>
                        <span class="discount">20% OFF</span>
                    </div>
                    <div class="product-desc" id="pDesc"></div>
                    <div class="features">
                        <div class="feature">
                            <span class="feature-icon">‚úì</span>
                            <span>Free Delivery</span>
                        </div>
                        <div class="feature">
                            <span class="feature-icon">‚úì</span>
                            <span>7 Days Return</span>
                        </div>
                        <div class="feature">
                            <span class="feature-icon">‚úì</span>
                            <span>1 Year Warranty</span>
                        </div>
                    </div>
                    <div class="product-btns">
                        <button class="btn-cart" onclick="addCart()">üõí Add to Cart</button>
                        <button class="btn-buy" onclick="buyNow()">‚ö° Buy Now</button>
                    </div>
                    <div class="nav-arrows">
                        <button class="arrow" onclick="prev()">‚Üê</button>
                        <button class="arrow" onclick="next()">‚Üí</button>
                    </div>
                </div>
            </div>

            <div class="section-title">AI Recommendations</div>
            <div class="products-grid" id="recomGrid"></div>
        </div>
    </div>

    <!-- CART -->
    <div id="cartPage" class="page">
        <div class="navbar">
            <div class="nav-logo" onclick="goHome()">Aryan's Market</div>
        </div>
        <div class="main">
            <div style="max-width: 1000px; margin: 0 auto;">
                <div class="section-title">Shopping Cart</div>
                <div id="cartItems"></div>
                <div id="cartSum"></div>
            </div>
        </div>
    </div>

    <!-- ADMIN -->
    <div id="adminPage" class="page">
        <div class="main">
            <div style="max-width: 1400px; margin: 0 auto;">
                <div class="admin-header">
                    <div class="admin-title">Admin Dashboard</div>
                    <button class="btn-logout" onclick="logout()">Logout</button>
                </div>
                <div class="admin-stats">
                    <div class="admin-stat">
                        <div class="stat-num" id="adminUsers">0</div>
                        <div class="stat-desc">Total Users</div>
                    </div>
                    <div class="admin-stat">
                        <div class="stat-num" id="adminOrders">0</div>
                        <div class="stat-desc">Total Orders</div>
                    </div>
                    <div class="admin-stat">
                        <div class="stat-num">‚Çπ<span id="adminRev">0</span></div>
                        <div class="stat-desc">Revenue</div>
                    </div>
                </div>
                <div class="admin-table">
                    <div style="font-size: 24px; font-weight: 700; margin-bottom: 25px;">Recent Orders</div>
                    <table>
                        <thead>
                            <tr>
                                <th>Order ID</th>
                                <th>Customer</th>
                                <th>Email</th>
                                <th>Items</th>
                                <th>Total</th>
                                <th>Date</th>
                                <th>Action</th>
                            </tr>
                        </thead>
                        <tbody id="adminTable"></tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <!-- CHATBOT -->
    <div class="chatbot">
        <button class="chatbot-toggle" onclick="toggleChat()">ü§ñ</button>
        <div class="chatbot-window" id="chatWindow">
            <div class="chat-header">
                <div class="chat-title">ü§ñ AI Assistant</div>
                <button class="chat-close" onclick="toggleChat()">√ó</button>
            </div>
            <div class="chat-messages" id="chatMsgs">
                <div class="chat-msg bot">
                    <div class="chat-bubble">Hi! How can I help you?</div>
                </div>
            </div>
            <div class="chat-input-area">
                <input type="text" class="chat-input" id="chatInput" placeholder="Type message..." onkeypress="chatEnter(event)">
                <button class="chat-send" onclick="sendChat()">‚û§</button>
            </div>
        </div>
    </div>

    <!-- VAN -->
    <div class="van" id="van">
        <div class="van-body">
            <div class="van-cabin"></div>
            <div class="van-cargo">
                <div class="van-door"></div>
                <div class="van-box"></div>
            </div>
            <div class="van-wheel"></div>
            <div class="van-wheel"></div>
        </div>
    </div>

    <!-- MODAL -->
    <div class="modal" id="modal">
        <div class="modal-content">
            <div class="success-icon">‚úÖ</div>
            <div class="success-title">Order Placed!</div>
            <div class="success-msg">Thank you for shopping</div>
            <div class="order-box">
                <div class="order-lbl">Order ID</div>
                <div class="order-id" id="orderId">ORD123</div>
            </div>
            <button class="btn btn-primary" style="width: auto; padding: 18px 50px;" onclick="closeModal()">Continue Shopping</button>
        </div>
    </div>

    <script>
        // STATE
        let user = null;
        let cart = [];
        let idx = 0;
        let filtered = [];
        let recognition = null;

        const PRODUCTS = [
            { id: 1, name: "iPhone 15 Pro Max", cat: "Electronics", price: 134900, old: 159900, img: "https://images.unsplash.com/photo-1678652197070-14254334f1cb?w=600&q=80", desc: "Latest flagship with A17 Pro chip" },
            { id: 2, name: "MacBook Pro M3", cat: "Electronics", price: 199900, old: 239900, img: "https://images.unsplash.com/photo-1517336714731-489689fd1ca8?w=600&q=80", desc: "Revolutionary M3 chip performance" },
            { id: 3, name: "Sony WH-1000XM5", cat: "Electronics", price: 29990, old: 34990, img: "https://images.unsplash.com/photo-1546435770-a3e426bf472b?w=600&q=80", desc: "Industry-leading noise cancellation" },
            { id: 4, name: "iPad Air M2", cat: "Electronics", price: 59900, old: 69900, img: "https://images.unsplash.com/photo-1544244015-0df4b3ffc6b0?w=600&q=80", desc: "Powerful M2 chip tablet" },
            { id: 5, name: "Canon EOS R6", cat: "Electronics", price: 249900, old: 289900, img: "https://images.unsplash.com/photo-1516035069371-29a1b244cc32?w=600&q=80", desc: "Professional mirrorless camera" },
            { id: 6, name: "Organic Basmati Rice 10kg", cat: "Grocery", price: 1499, old: 1799, img: "https://images.unsplash.com/photo-1586201375761-83865001e31c?w=600&q=80", desc: "Premium aged basmati" },
            { id: 7, name: "Dry Fruits Mix 1kg", cat: "Grocery", price: 1299, old: 1599, img: "https://images.unsplash.com/photo-1607161466485-c2101f8f4aa3?w=600&q=80", desc: "Healthy mix of nuts" },
            { id: 8, name: "Olive Oil 1L", cat: "Grocery", price: 899, old: 1199, img: "https://images.unsplash.com/photo-1474979266404-7eaacbcd87c5?w=600&q=80", desc: "Cold pressed organic" },
            { id: 9, name: "Darjeeling Tea 500g", cat: "Grocery", price: 599, old: 799, img: "https://images.unsplash.com/photo-1564890369478-c89ca6d9cde9?w=600&q=80", desc: "Premium tea collection" },
            { id: 10, name: "Organic Honey 1kg", cat: "Grocery", price: 650, old: 850, img: "https://images.unsplash.com/photo-1587049352846-4a222e784acc?w=600&q=80", desc: "Pure forest honey" },
            { id: 11, name: "Cotton Formal Shirt", cat: "Fashion", price: 1299, old: 1799, img: "https://images.unsplash.com/photo-1602810318383-e386cc2a3ccf?w=600&q=80", desc: "Elegant formal wear" },
            { id: 12, name: "Evening Dress", cat: "Fashion", price: 3499, old: 4999, img: "https://images.unsplash.com/photo-1572804013309-59a88b7e92f1?w=600&q=80", desc: "Stunning party wear" },
            { id: 13, name: "Levi's Jeans", cat: "Fashion", price: 2499, old: 3299, img: "https://images.unsplash.com/photo-1542272604-787c3835535d?w=600&q=80", desc: "Classic denim" },
            { id: 14, name: "Nike Jacket", cat: "Fashion", price: 3499, old: 4499, img: "https://images.unsplash.com/photo-1551028719-00167b16eac5?w=600&q=80", desc: "Premium sports jacket" },
            { id: 15, name: "Business Suit", cat: "Fashion", price: 12999, old: 16999, img: "https://images.unsplash.com/photo-1594938291221-94f18cbb5660?w=600&q=80", desc: "Professional 3-piece" },
            { id: 16, name: "Air Fryer XXL", cat: "Home", price: 9999, old: 12999, img: "https://images.unsplash.com/photo-1585515320310-259814833e62?w=600&q=80", desc: "Healthy cooking" },
            { id: 17, name: "Mixer Grinder", cat: "Home", price: 5499, old: 6999, img: "https://images.unsplash.com/photo-1570222094114-d054a817e56b?w=600&q=80", desc: "750W powerful motor" },
            { id: 18, name: "Cotton Bedsheet", cat: "Home", price: 2999, old: 3999, img: "https://images.unsplash.com/photo-1631049307264-da0ec9d70304?w=600&q=80", desc: "Luxury king size" },
            { id: 19, name: "Wall Clock", cat: "Home", price: 1499, old: 1999, img: "https://images.unsplash.com/photo-1563861826100-9cb868fdbe1c?w=600&q=80", desc: "Modern design" },
            { id: 20, name: "LED Lamp", cat: "Home", price: 1799, old: 2299, img: "https://images.unsplash.com/photo-1507473885765-e6ed057f782c?w=600&q=80", desc: "Adjustable brightness" },
        ];

        // INIT
        function init() {
            particlesJS('particles-js', {
                particles: {
                    number: { value: 60 },
                    color: { value: '#8B5CF6' },
                    shape: { type: 'circle' },
                    opacity: { value: 0.4 },
                    size: { value: 3 },
                    line_linked: { enable: true, color: '#8B5CF6', opacity: 0.3 },
                    move: { enable: true, speed: 2 }
                }
            });

            loadData();
            filtered = [...PRODUCTS];
            updateProduct();
            updateCartBadge();
            genRecom();

            setTimeout(() => {
                const saved = localStorage.getItem('currentUser');
                if (saved) {
                    user = JSON.parse(saved);
                    showPage('homePage');
                } else {
                    showPage('authPage');
                }
            }, 3200);

            initVoice();
        }

        function loadData() {
            const u = localStorage.getItem('currentUser');
            const c = localStorage.getItem('userCart');
            if (u) user = JSON.parse(u);
            if (c) cart = JSON.parse(c);
        }

        function save() {
            if (user) localStorage.setItem('currentUser', JSON.stringify(user));
            localStorage.setItem('userCart', JSON.stringify(cart));
        }

        function showPage(id) {
            document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
            document.getElementById(id).classList.add('active');
        }

        // AUTH
        function showLogin() {
            document.getElementById('loginForm').classList.remove('hidden');
            document.getElementById('signupForm').classList.add('hidden');
        }

        function showSignup() {
            document.getElementById('loginForm').classList.add('hidden');
            document.getElementById('signupForm').classList.remove('hidden');
        }

        function login() {
            const email = document.getElementById('loginEmail').value.trim();
            const pass = document.getElementById('loginPass').value.trim();

            if (!email || !pass) {
                notify('Fill all fields', 'error');
                return;
            }

            if (email === 'aryanarvindpandit@gmail.com' && pass === '@ryan777') {
                loadAdmin();
                return;
            }

            const users = JSON.parse(localStorage.getItem('users') || '[]');
            const found = users.find(u => u.email === email && u.password === pass);

            if (found) {
                user = found;
                save();
                notify(`Welcome ${found.name}!`, 'success');
                setTimeout(() => showPage('homePage'), 1000);
            } else {
                notify('Invalid! Please signup', 'error');
            }
        }

        function signup() {
            const name = document.getElementById('signupName').value.trim();
            const email = document.getElementById('signupEmail').value.trim();
            const pass = document.getElementById('signupPass').value.trim();

            if (!name || !email || !pass) {
                notify('Fill all fields', 'error');
                return;
            }

            const users = JSON.parse(localStorage.getItem('users') || '[]');

            if (users.find(u => u.email === email)) {
                notify('Email exists!', 'error');
                return;
            }

            const newUser = { name, email, password: pass, joined: new Date().toISOString() };
            users.push(newUser);
            localStorage.setItem('users', JSON.stringify(users));

            user = newUser;
            save();
            notify(`Welcome ${name}!`, 'success');
            setTimeout(() => showPage('homePage'), 1000);
        }

        function resetPass() {
            const email = prompt('Enter email:');
            if (!email) return;

            const users = JSON.parse(localStorage.getItem('users') || '[]');
            const found = users.find(u => u.email === email);

            if (found) {
                setTimeout(() => alert(`Demo: Password is "${found.password}"`), 500);
                notify('Recovery email sent', 'success');
            } else {
                notify('Email not found', 'error');
            }
        }

        // PRODUCTS
        function updateProduct() {
            if (filtered.length === 0) return;

            const p = filtered[idx];
            document.getElementById('pImg').src = p.img;
            document.getElementById('pCat').textContent = p.cat;
            document.getElementById('pName').textContent = p.name;
            document.getElementById('pPrice').textContent = '‚Çπ' + p.price.toLocaleString();
            document.getElementById('pOld').textContent = '‚Çπ' + p.old.toLocaleString();
            document.getElementById('pDesc').textContent = p.desc;
        }

        function next() {
            idx = (idx + 1) % filtered.length;
            updateProduct();
        }

        function prev() {
            idx = (idx - 1 + filtered.length) % filtered.length;
            updateProduct();
        }

        function filterCat(cat) {
            filtered = PRODUCTS.filter(p => p.cat === cat);
            idx = 0;
            document.getElementById('catTitle').textContent = cat;
            updateProduct();
            genRecom();
        }

        function search() {
            const q = document.getElementById('searchInput').value.toLowerCase();
            
            if (!q) {
                filtered = [...PRODUCTS];
                document.getElementById('catTitle').textContent = 'Featured Products';
            } else {
                filtered = PRODUCTS.filter(p => 
                    p.name.toLowerCase().includes(q) || 
                    p.cat.toLowerCase().includes(q)
                );
                document.getElementById('catTitle').textContent = `Search: "${q}"`;
            }
            
            idx = 0;
            updateProduct();
            genRecom();
        }

        function genRecom() {
            const grid = document.getElementById('recomGrid');
            const recom = [...PRODUCTS].sort(() => 0.5 - Math.random()).slice(0, 6);

            grid.innerHTML = recom.map(p => `
                <div class="product-card" onclick="viewProd(${p.id})">
                    <img src="${p.img}" class="card-img">
                    <div class="card-content">
                        <div class="card-name">${p.name}</div>
                        <div class="card-price">‚Çπ${p.price.toLocaleString()}</div>
                        <div class="card-btns">
                            <button class="card-btn card-btn-cart" onclick="event.stopPropagation(); quickAdd(${p.id})">Add</button>
                            <button class="card-btn card-btn-buy" onclick="event.stopPropagation(); quickBuy(${p.id})">Buy</button>
                        </div>
                    </div>
                </div>
            `).join('');
        }

        function viewProd(id) {
            const i = filtered.findIndex(p => p.id === id);
            if (i !== -1) {
                idx = i;
                updateProduct();
                document.querySelector('.product-show').scrollIntoView({ behavior: 'smooth' });
            }
        }

        function quickAdd(id) {
            const p = PRODUCTS.find(p => p.id === id);
            if (!p) return;

            const ex = cart.find(i => i.id === id);
            if (ex) {
                ex.qty++;
            } else {
                cart.push({ ...p, qty: 1 });
            }

            save();
            updateCartBadge();
            notify(`${p.name} added!`, 'success');
        }

        function quickBuy(id) {
            cart = [];
            quickAdd(id);
            setTimeout(() => checkout(), 500);
        }

        // VOICE
        function initVoice() {
            if ('webkitSpeechRecognition' in window || 'SpeechRecognition' in window) {
                const SR = window.SpeechRecognition || window.webkitSpeechRecognition;
                recognition = new SR();
                recognition.continuous = false;

                recognition.onresult = function(e) {
                    const text = e.results[0][0].transcript;
                    document.getElementById('searchInput').value = text;
                    search();
                    document.getElementById('voiceBtn').classList.remove('active');
                };

                recognition.onend = () => document.getElementById('voiceBtn').classList.remove('active');
            }
        }

        function voiceSearch() {
            if (recognition) {
                document.getElementById('voiceBtn').classList.add('active');
                recognition.start();
                notify('Listening...', 'info');
            } else {
                notify('Voice not supported', 'error');
            }
        }

        // CHATBOT
        function toggleChat() {
            document.getElementById('chatWindow').classList.toggle('active');
        }

        function sendChat() {
            const input = document.getElementById('chatInput');
            const msg = input.value.trim();
            
            if (!msg) return;

            addMsg(msg, 'user');
            input.value = '';

            setTimeout(() => {
                const res = getAIRes(msg);
                addMsg(res, 'bot');
            }, 800);
        }

        function chatEnter(e) {
            if (e.key === 'Enter') sendChat();
        }

        function addMsg(text, sender) {
            const div = document.createElement('div');
            div.className = `chat-msg ${sender}`;
            div.innerHTML = `<div class="chat-bubble">${text}</div>`;
            document.getElementById('chatMsgs').appendChild(div);
            document.getElementById('chatMsgs').scrollTop = 999999;
        }

        function getAIRes(msg) {
            msg = msg.toLowerCase();

            if (msg.includes('hello') || msg.includes('hi')) {
                return 'Hi! How can I help you?';
            } else if (msg.includes('phone') || msg.includes('iphone')) {
                filterCat('Electronics');
                return 'Check out iPhone 15 Pro Max!';
            } else if (msg.includes('laptop')) {
                filterCat('Electronics');
                return 'MacBook Pro M3 is amazing!';
            } else if (msg.includes('clothes') || msg.includes('fashion')) {
                filterCat('Fashion');
                return 'Browse our fashion collection!';
            } else {
                return 'I can help with products, search, and recommendations!';
            }
        }

        // CART
        function addCart() {
            if (!user) {
                notify('Please login', 'error');
                showPage('authPage');
                return;
            }

            const p = filtered[idx];
            quickAdd(p.id);
        }

        function buyNow() {
            if (!user) {
                notify('Please login', 'error');
                showPage('authPage');
                return;
            }

            const p = filtered[idx];
            quickBuy(p.id);
        }

        function updateCartBadge() {
            const total = cart.reduce((sum, i) => sum + i.qty, 0);
            document.getElementById('cartBadge').textContent = total;
        }

        function openCart() {
            if (!user) {
                notify('Please login', 'error');
                showPage('authPage');
                return;
            }

            showPage('cartPage');
            renderCart();
        }

        function renderCart() {
            const items = document.getElementById('cartItems');
            const sum = document.getElementById('cartSum');

            if (cart.length === 0) {
                items.innerHTML = `
                    <div class="empty">
                        <div class="empty-icon">üõí</div>
                        <div class="empty-text">Cart is empty</div>
                        <button class="btn btn-primary" style="margin-top: 30px;" onclick="goHome()">Start Shopping</button>
                    </div>
                `;
                sum.innerHTML = '';
                return;
            }

            let subtotal = 0;

            items.innerHTML = cart.map(i => {
                const t = i.price * i.qty;
                subtotal += t;
                return `
                    <div class="cart-item">
                        <img src="${i.img}" class="cart-img">
                        <div class="cart-details">
                            <div class="cart-name">${i.name}</div>
                            <div class="cart-price">‚Çπ${t.toLocaleString()}</div>
                            <div class="qty-control">
                                <button class="qty-btn" onclick="updateQty(${i.id}, -1)">-</button>
                                <span style="font-size: 18px; font-weight: 700;">${i.qty}</span>
                                <button class="qty-btn" onclick="updateQty(${i.id}, 1)">+</button>
                            </div>
                        </div>
                        <button class="btn-remove" onclick="remove(${i.id})">Remove</button>
                    </div>
                `;
            }).join('');

            const delivery = subtotal > 499 ? 0 : 40;
            const total = subtotal + delivery;

            sum.innerHTML = `
                <div class="cart-summary">
                    <div class="summary-row">
                        <span>Subtotal:</span>
                        <span>‚Çπ${subtotal.toLocaleString()}</span>
                    </div>
                    <div class="summary-row">
                        <span>Delivery:</span>
                        <span>${delivery === 0 ? 'FREE' : '‚Çπ' + delivery}</span>
                    </div>
                    <div class="summary-total">
                        <span>Total:</span>
                        <span class="total-amt">‚Çπ${total.toLocaleString()}</span>
                    </div>
                    <button class="btn-checkout" onclick="checkout()">Checkout</button>
                </div>
            `;
        }

        function updateQty(id, change) {
            const item = cart.find(i => i.id === id);
            if (!item) return;

            item.qty += change;
            
            if (item.qty <= 0) {
                remove(id);
                return;
            }

            save();
            updateCartBadge();
            renderCart();
        }

        function remove(id) {
            cart = cart.filter(i => i.id !== id);
            save();
            updateCartBadge();
            renderCart();
        }

        function checkout() {
            if (cart.length === 0) {
                notify('Cart is empty', 'error');
                return;
            }

            const van = document.getElementById('van');
            van.classList.add('active');

            setTimeout(() => {
                van.classList.remove('active');
                completeOrder();
            }, 5500);
        }

        function completeOrder() {
            const oid = 'ORD' + Date.now();
            const total = cart.reduce((sum, i) => sum + (i.price * i.qty), 0);

            const order = {
                orderId: oid,
                customer: user.name,
                email: user.email,
                items: cart.length,
                total,
                date: new Date().toLocaleString(),
                products: [...cart]
            };

            const orders = JSON.parse(localStorage.getItem('orders') || '[]');
            orders.push(order);
            localStorage.setItem('orders', JSON.stringify(orders));

            cart = [];
            save();
            updateCartBadge();

            document.getElementById('orderId').textContent = oid;
            document.getElementById('modal').classList.add('active');
        }

        function closeModal() {
            document.getElementById('modal').classList.remove('active');
            goHome();
        }

        function goHome() {
            showPage('homePage');
        }

        // PROFILE
        function profile() {
            if (!user) {
                notify('Please login', 'error');
                showPage('authPage');
                return;
            }

            alert(`üë§ ${user.name}\nüìß ${user.email}\n\nüìû aryanarvindpandit@gmail.com\nüí≥ aryanwithrizz@ybl`);
        }

        // ADMIN
        function loadAdmin() {
            showPage('adminPage');

            const users = JSON.parse(localStorage.getItem('users') || '[]');
            const orders = JSON.parse(localStorage.getItem('orders') || '[]');
            const rev = orders.reduce((sum, o) => sum + o.total, 0);

            document.getElementById('adminUsers').textContent = users.length;
            document.getElementById('adminOrders').textContent = orders.length;
            document.getElementById('adminRev').textContent = rev.toLocaleString();

            const tbody = document.getElementById('adminTable');
            
            if (orders.length === 0) {
                tbody.innerHTML = '<tr><td colspan="7" style="text-align:center;padding:40px;">No orders</td></tr>';
                return;
            }

            tbody.innerHTML = orders.reverse().map(o => `
                <tr>
                    <td>${o.orderId}</td>
                    <td>${o.customer}</td>
                    <td>${o.email}</td>
                    <td>${o.items}</td>
                    <td>‚Çπ${o.total.toLocaleString()}</td>
                    <td>${o.date}</td>
                    <td><button class="btn-action" onclick="cancelOrder('${o.orderId}')">Cancel</button></td>
                </tr>
            `).join('');
        }

        function cancelOrder(oid) {
            if (confirm('Cancel order?')) {
                let orders = JSON.parse(localStorage.getItem('orders') || '[]');
                orders = orders.filter(o => o.orderId !== oid);
                localStorage.setItem('orders', JSON.stringify(orders));
                loadAdmin();
                notify('Order cancelled', 'success');
            }
        }

        function logout() {
            showPage('authPage');
        }

        // NOTIFY
        function notify(msg, type = 'info') {
            const div = document.createElement('div');
            div.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                background: ${type === 'success' ? 'var(--success)' : type === 'error' ? 'var(--danger)' : 'var(--info)'};
                color: #fff;
                padding: 16px 28px;
                border-radius: 12px;
                box-shadow: 0 10px 30px rgba(0,0,0,0.3);
                z-index: 10001;
                font-weight: 600;
                animation: slideIn 0.3s;
            `;
            div.textContent = msg;
            document.body.appendChild(div);

            setTimeout(() => {
                div.style.animation = 'slideOut 0.3s';
                setTimeout(() => div.remove(), 300);
            }, 3000);
        }

        const style = document.createElement('style');
        style.textContent = `
            @keyframes slideIn {
                from { transform: translateX(400px); opacity: 0; }
                to { transform: translateX(0); opacity: 1; }
            }
            @keyframes slideOut {
                from { transform: translateX(0); opacity: 1; }
                to { transform: translateX(400px); opacity: 0; }
            }
        `;
        document.head.appendChild(style);

        window.addEventListener('load', init);
    </script>
</body>
</html>
